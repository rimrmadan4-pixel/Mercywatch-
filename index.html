<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Mercy Watch ‚Äì Mobile Hospital</title>
  <style>
    :root{
      --bg:#0f0f14;
      --card:#151521;
      --ink:#f7f7fb;
      --muted:#b7b2c8;
      --brand:#b598ff; /* soft violet */
      --brand-strong:#8b5cf6; /* stronger violet */
      --ok:#22c55e;
      --warn:#f59e0b;
      --danger:#ef4444;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", sans-serif;
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }
    .app{min-height:100%; display:flex; flex-direction:column}
    header{
      position:sticky; top:0; z-index:10;
      background:linear-gradient(135deg, var(--card) 0%, #1f1b2e 100%);
      border-bottom-left-radius:22px; border-bottom-right-radius:22px;
      padding:18px 16px 26px; box-shadow:var(--shadow)
    }
    .title{display:flex; align-items:center; gap:12px}
    .logo{width:40px;height:40px;border-radius:50%;background:#201a33; display:grid; place-items:center;}
    .logo svg{width:24px;height:24px; color:var(--brand)}
    .subtitle{margin-top:4px;color:#d9d2ff;font-size:14px}.right{margin-inline-start:auto; display:flex; gap:10px; align-items:center}
.toggle{background:#201a33; color:#dcd6ff; border:1px solid #2b2540; padding:8px 10px; border-radius:12px; cursor:pointer}

main{padding:16px; padding-bottom:120px}
.grid{display:grid; gap:12px; grid-template-columns: repeat(2, minmax(0,1fr));}
@media (min-width:720px){ .grid{grid-template-columns: repeat(4, minmax(0,1fr));} main{max-width:1100px; margin:0 auto} }

.card{background:var(--card); border-radius:var(--radius); padding:14px; box-shadow:var(--shadow); border:1px solid #232138}
.card h3{margin:0 0 6px 0; font-size:14px; color:var(--muted)}
.value{font-size:24px; font-weight:800}
.tag{display:inline-flex; align-items:center; gap:6px; font-size:12px; padding:4px 8px; border-radius:999px; background:#0e0d15; color:var(--muted); box-shadow:var(--shadow); border:1px solid #26233c}

.row{display:flex; align-items:center; justify-content:space-between; gap:12px}

.section{margin-top:16px}
.section h2{font-size:16px; margin:0 0 10px 0; color:#eae6ff}

.actions{display:flex; gap:10px; flex-wrap:wrap}
button, .btn{appearance:none; border:none; cursor:pointer; border-radius:14px; padding:12px 14px; font-weight:800; background:var(--brand-strong); color:#07060d; box-shadow:var(--shadow)}
button.secondary{background:#0e0d15; color:var(--brand); border:1px solid #2b2540}
button.ghost{background:transparent; color:var(--brand); border:1px dashed var(--brand)}

.sos{position:fixed; inset-inline:16px; bottom:16px; z-index:20; display:flex; gap:12px; align-items:center; justify-content:space-between; background:#0e0d15; border:2px solid var(--brand); color:var(--brand); border-radius:20px; padding:14px 16px; box-shadow:var(--shadow)}
.sos .big{background:var(--danger); color:#fff; border:none; padding:14px 18px; border-radius:16px; font-size:16px}

.pill-box{display:flex; align-items:center; gap:10px}
.pill-status{padding:6px 10px; border-radius:999px; background:#0e0d15; box-shadow:var(--shadow); font-size:12px; border:1px solid #26233c}

.records-list{display:grid; gap:8px}
.record{background:#0e0d15; border:1px solid #232138; padding:10px; border-radius:12px}

.toast{position:fixed; top:14px; left:50%; transform:translateX(-50%); background:#111; color:#fff; padding:10px 14px; border-radius:999px; font-size:12px; opacity:0; pointer-events:none; transition:opacity .25s ease}
.toast.show{opacity:1}

.assistant{display:flex; align-items:center; gap:10px}
.assistant input{flex:1; padding:10px 12px; border-radius:12px; border:1px solid #2b2540; background:#0e0d15; color:#fff}

.map-link{color:var(--brand); text-decoration:none}

  </style>
</head>
<body>
<div class="app">
  <header>
    <div class="row">
      <div class="title">
        <div class="logo" aria-hidden="true">
          <!-- simple heart icon -->
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M12 21s-6.5-4.35-9.5-7.35A5.5 5.5 0 1 1 12 5a5.5 5.5 0 1 1 9.5 8.65C18.5 16.65 12 21 12 21z"/>
          </svg>
        </div>
        <div>
          <div style="font-weight:900; font-size:20px">Mercy Watch</div>
          <div class="subtitle">A mobile hospital on your wrist</div>
        </div>
      </div>
      <div class="right">
        <button class="toggle" id="themeBtn" title="Toggle Light/Dark">Dark ‚Ä¢ Light</button>
      </div>
    </div>
  </header>  <main>
    <!-- Vitals -->
    <div class="section">
      <h2>Vital Signs</h2>
      <div class="grid">
        <div class="card" id="bpCard">
          <div class="row"><h3>Blood Pressure</h3><span class="tag" id="bpTag">‚Äî</span></div>
          <div class="value" id="bpVal">120/80</div>
        </div>
        <div class="card" id="hrCard">
          <div class="row"><h3>Heart Rate (bpm)</h3><span class="tag" id="hrTag">‚Äî</span></div>
          <div class="value" id="hrVal">72</div>
        </div>
        <div class="card" id="glCard">
          <div class="row"><h3>Glucose (mmol/L)</h3><span class="tag" id="glTag">‚Äî</span></div>
          <div class="value" id="glVal">5.6</div>
        </div>
        <div class="card" id="spoCard">
          <div class="row"><h3>SpO‚ÇÇ</h3><span class="tag" id="spoTag">‚Äî</span></div>
          <div class="value" id="spoVal">98%</div>
        </div>
      </div>
      <div class="actions" style="margin-top:10px">
        <button class="secondary" id="refreshBtn">Refresh</button>
        <button class="ghost" id="saveVitals">Save to Medical Record</button>
      </div>
    </div><!-- Pill compartment & Medical card slot -->
<div class="section">
  <h2>Pill Compartment & ‚ÄúMedical Record‚Äù Card</h2>
  <div class="card">
    <div class="row pill-box">
      <div>
        <strong>Pill Compartment:</strong>
        <span class="pill-status" id="pillState">Locked</span>
      </div>
      <button id="pillButton" title="Long-press to open">Open (Long Press)</button>
    </div>
    <div style="margin-top:10px" class="row">
      <div><strong>Card Slot:</strong> ‚ÄúMedical Record‚Äù</div>
      <button class="secondary" id="addNoteBtn">Add Note</button>
    </div>
    <div id="records" class="records-list" style="margin-top:10px"></div>
  </div>
</div>

<!-- AI Voice Assistant -->
<div class="section">
  <h2>AI Voice Medical Assistant</h2>
  <div class="card assistant">
    <input id="assistantInput" placeholder="Ask: When is my pill time? How to sleep better?"/>
    <button id="speakBtn">Reply</button>
    <button class="secondary" id="micBtn">üéôÔ∏è</button>
  </div>
  <div id="assistantOut" style="margin-top:8px; color:var(--muted)"></div>
</div>

<!-- Location & Emergency -->
<div class="section">
  <h2>Location & Emergency</h2>
  <div class="card">
    <div class="row">
      <div id="geoStatus">Location not acquired yet.</div>
      <button id="locBtn" class="secondary">Get Location</button>
    </div>
    <div style="margin-top:8px">
      <a id="mapLink" class="map-link" target="_blank" rel="noopener"></a>
    </div>
  </div>
</div>

  </main>  <!-- SOS bar -->  <div class="sos" role="region" aria-label="Emergency bar">
    <div style="display:flex;align-items:center;gap:10px">
      <strong>Emergency</strong>
      <span style="font-size:12px;color:var(--muted)">Instant call to EMS or family</span>
    </div>
    <div class="actions">
      <a class="btn big" href="tel:112">SOS</a>
      <button class="secondary" id="shareBtn">Share Status</button>
    </div>
  </div>  <div class="toast" id="toast" role="status" aria-live="polite"></div>
</div><script>
// Quick DOM
const $ = s => document.querySelector(s);
const toast = (m)=>{const t=$('#toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),1800)}

// Theme toggle (persist to localStorage)
(function initTheme(){
  const saved = localStorage.getItem('mw-theme');
  if(saved==='light') setLight();
})();
$('#themeBtn').addEventListener('click',()=>{
  const isLight = document.documentElement.dataset.theme==='light';
  if(isLight){ setDark(); } else { setLight(); }
});
function setLight(){
  document.documentElement.dataset.theme='light';
  const s = document.documentElement.style;
  s.setProperty('--bg','#ffffff');
  s.setProperty('--card','#f7f5fb');
  s.setProperty('--ink','#1f1b2e');
  s.setProperty('--muted','#6b6282');
  s.setProperty('--brand','#6a0dad');
  s.setProperty('--brand-strong','#7c3aed');
  s.setProperty('--shadow','0 6px 20px rgba(0,0,0,.08)');
  localStorage.setItem('mw-theme','light');
}
function setDark(){
  document.documentElement.dataset.theme='dark';
  const s = document.documentElement.style;
  s.setProperty('--bg','#0f0f14');
  s.setProperty('--card','#151521');
  s.setProperty('--ink','#f7f7fb');
  s.setProperty('--muted','#b7b2c8');
  s.setProperty('--brand','#b598ff');
  s.setProperty('--brand-strong','#8b5cf6');
  s.setProperty('--shadow','0 10px 30px rgba(0,0,0,.35)');
  localStorage.setItem('mw-theme','dark');
}

// Vitals simulation
function rand(min,max){return Math.round(Math.random()*(max-min)+min)}
function updateVitals(){
  const sys = rand(105,135), dia = rand(65,88);
  const hr = rand(60,95);
  const gl = (Math.random()*1.8 + 4.8).toFixed(1);
  const spo = rand(94,100);
  $('#bpVal').textContent = `${sys}/${dia}`;
  $('#hrVal').textContent = hr;
  $('#glVal').textContent = gl;
  $('#spoVal').textContent = `${spo}%`;
  tag('#bpTag', (sys<135 && dia<85) ? 'Normal' : 'High', (sys<135 && dia<85) ? 'ok' : 'warn');
  tag('#hrTag', (hr>=60 && hr<=100) ? 'Normal' : 'Alert', (hr>=60 && hr<=100) ? 'ok' : 'warn');
  tag('#glTag', (gl>=4.0 && gl<=7.0) ? 'Normal' : 'Alert', (gl>=4.0 && gl<=7.0) ? 'ok' : 'warn');
  tag('#spoTag', (spo>=95) ? 'Good' : 'Alert', (spo>=95) ? 'ok' : 'warn');
}
function tag(sel, txt, level){ const el=$(sel); el.textContent=txt; el.style.color = level==='ok' ? 'var(--ok)' : level==='warn' ? 'var(--warn)' : 'var(--muted)'; }
$('#refreshBtn').addEventListener('click', ()=>{ updateVitals(); toast('Vitals refreshed') })

// Save vitals to localStorage
$('#saveVitals').addEventListener('click', ()=>{
  const note = `BP:${$('#bpVal').textContent}, HR:${$('#hrVal').textContent}, GL:${$('#glVal').textContent}, SpO2:${$('#spoVal').textContent}`;
  const arr = JSON.parse(localStorage.getItem('records')||'[]');
  arr.unshift({ t:new Date().toLocaleString(), note });
  localStorage.setItem('records', JSON.stringify(arr));
  renderRecords(); toast('Saved to Medical Record')
})

function renderRecords(){
  const wrap = $('#records'); wrap.innerHTML='';
  const arr = JSON.parse(localStorage.getItem('records')||'[]');
  if(!arr.length){ wrap.innerHTML = '<div class="record">No notes yet.</div>'; return }
  arr.slice(0,5).forEach(r=>{
    const d=document.createElement('div'); d.className='record'; d.textContent = `${r.t} ‚Äî ${r.note}`; wrap.appendChild(d);
  })
}
$('#addNoteBtn').addEventListener('click', ()=>{
  const txt = prompt('Add a short note to your medical record:');
  if(!txt) return; const arr = JSON.parse(localStorage.getItem('records')||'[]');
  arr.unshift({ t:new Date().toLocaleString(), note: txt });
  localStorage.setItem('records', JSON.stringify(arr));
  renderRecords();
})

// Pill compartment
let pressTimer=null; let isOpen=false;
const pillBtn = $('#pillButton'); const pillState=$('#pillState');
function setPill(open){ isOpen=open; pillState.textContent = open? 'Open (10s)': 'Locked'; pillState.style.color = open? 'var(--warn)':'inherit' }
['mousedown','touchstart'].forEach(evn=> pillBtn.addEventListener(evn, ()=>{
  pressTimer = setTimeout(()=>{ setPill(true); toast('Pill compartment opened manually'); setTimeout(()=>setPill(false), 10000) }, 1200);
}))
['mouseup','mouseleave','touchend','touchcancel'].forEach(evn=> pillBtn.addEventListener(evn, ()=>{ clearTimeout(pressTimer) }))

// Assistant (basic rules + TTS + Speech Recognition)
const answers = {
  'pill':'Please take your medication on time. If you feel dizzy, contact your doctor.',
  'glucose':'Monitor glucose regularly and keep hydrated. For sudden drops, follow your doctor plan.',
  'pressure':'Sit and relax for 5 minutes, then re-check blood pressure.',
  'sleep':'Keep a regular sleep schedule and reduce caffeine after noon.'
}
function reply(text){
  $('#assistantOut').textContent = text; try{ speechSynthesis.cancel(); speechSynthesis.speak(new SpeechSynthesisUtterance(text)) }catch(e){}
}
$('#speakBtn').addEventListener('click', ()=>{
  const q = $('#assistantInput').value.trim().toLowerCase();
  if(!q){ reply('How can I help you today?'); return }
  const key = Object.keys(answers).find(k=> q.includes(k));
  reply(key? answers[key] : 'General tip: drink water, rest, and consult your physician if symptoms persist.');
})

$('#micBtn').addEventListener('click', ()=>{
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition; if(!SR){ toast('Speech recognition is not supported.'); return }
  const r=new SR(); r.lang='en-US'; r.onresult=(e)=>{ $('#assistantInput').value = e.results[0][0].transcript; toast('Listening done') }; r.start();
})

// Geolocation
$('#locBtn').addEventListener('click', ()=>{
  if(!navigator.geolocation){ toast('Geolocation not supported'); return }
  navigator.geolocation.getCurrentPosition(pos=>{
    const {latitude, longitude} = pos.coords;
    $('#geoStatus').textContent = `Current location: ${latitude.toFixed(5)}, ${longitude.toFixed(5)}`;
    const url = `https://maps.google.com/?q=${latitude},${longitude}`;
    const a=$('#mapLink'); a.textContent = 'Open in Maps'; a.href=url; toast('Location acquired')
  }, ()=> toast('Failed to get location'))
})

// Share
$('#shareBtn').addEventListener('click', async()=>{
  try{
    if(navigator.share){ await navigator.share({ title:'Mercy Watch', text:'Medical emergency ‚Äî please help', url: location.href }); toast('Shared') }
    else{ toast('Share API not supported') }
  }catch(e){ toast('Share cancelled') }
})

// Init
updateVitals(); renderRecords();
</script></body>
</html>
